<!DOCTYPE html>
<html lang="en" prefix="og:http://ogp.me/ns#">
	<head>
		<title>Firefox Privacy Guide - Cookie Engineer's Web Log</title>

		<!-- Meta -->
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=2, user-scalable=yes">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="creator" content="Cookie Engineer">
		<meta name="description" content="Firefox Privacy Guide">
		<meta name="keywords" content="privacy, security, desktop">
		<meta name="generator" content="Beer and VIM night coding sessions">
		<meta name="robots" content="index, follow">
		<link rel="alternate" type="application/rss+xml" href="../feed.xml">

		<!-- Social Meta -->
		<meta property="og:image" itemprop="image" content="https://cookie.engineer/design/about/avatar/cookiengineer.png">
		<meta property="og:title" content="Firefox Privacy Guide - Cookie Engineer's Web Log">
		<meta property="og:site_name" content="Cookie Engineer's Web Log">
		<meta property="og:description" content="Best Practices for Firefox to make it respect your Privacy.">
		<meta property="og:type" content="article">
		<meta name="twitter:card" content="summary">
		<meta name="twitter:domain" content="cookie.engineer">
		<meta name="twitter:title" itemprop="name" content="Firefox Privacy Guide - Cookie Engineer's Web Log">
		<meta name="twitter:description" itemprop="description" content="Best Practices for Firefox to make it respect your Privacy.">

		<!-- Website Design -->
		<link rel="stylesheet" href="/design/layout/index.css">
		<link rel="stylesheet" href="/weblog/design/index.css">

		<!-- Weblog Design -->
		<link rel="stylesheet" href="/weblog/design/layout/highlight.css">
		<link rel="stylesheet" href="/weblog/design/layout/article.css">
		<script src="/weblog/design/layout/highlight.js"></script>
		<script src="/weblog/design/layout/article.js" defer></script>

		<!-- Website Functionality -->
		<link rel="stylesheet" href="/design/menu/index.css">
		<script src="/design/menu/index.js" defer></script>

		<!-- Magic: Copy/Paste -->
		<link rel="stylesheet" href="/design/magic/index.css">
		<script src="/design/magic/index.js" defer></script>

	</head>
	<body>
		<header>
			<aside id="menu" class="visible">
				<a id="menu-button" href="#menu">Menu</a>
				<a class="icon-section" href="/index.html">About&nbsp;Me</a>
				<a class="icon-section" href="/projects.html">Projects</a>
				<a class="icon-section" href="/talks.html">Talks</a>
				<a class="icon-section" href="/contact.html">Contact</a>
				<a class="icon-section" href="/weblog/index.html">Web&nbsp;Log</a>
			</aside>
			<aside id="toc">
				<a class="section" href="#disable-telemetry-service">Disable Telemetry Service</a>
				<a class="section" href="#disable-normandy-services">Disable Normandy Services</a>
				<a class="section" href="#disable-crash-reporter">Disable Crash Reporter</a>
				<a class="section" href="#disable-google-safebrowsing">Disable Google Safebrowsing</a>
				<a class="section" href="#disable-url-bar-suggestions">Disable URL Bar Suggestions</a>
				<a class="section" href="#disable-firefox-pocket">Disable Firefox Pocket</a>
				<a class="section" href="#disable-network-prefetching">Disable Network Prefetching</a>
				<a class="section" href="#disable-geolocation-services">Disable Geolocation Services</a>
				<a class="section" href="#disable-captive-portal-detector">Disable Captive Portal Detector</a>
				<a class="section" href="#disable-tls-ocsp-checks">Disable TLS OCSP Checks</a>
				<a class="section" href="#disable-privacy-compromising-dom-apis">Disable Privacy-Compromising DOM APIs</a>
				<a class="section" href="#disable-new-tab-page-trackers">Disable New Tab Page Trackers</a>
				<a class="section" href="#fingerprinting-and-cookies">Fingerprinting and Cookies</a>
				<a class="section" href="#privacy-enhancing-extensions">Privacy Enhancing Extensions</a>
				<a class="section" href="#firejail">Firejail</a>
			</aside>
		</header>
		<section id="article" class="article">
			<h1>Firefox Privacy Guide</h1>
			<article>
				<section>
					<p>
						Changing settings can be cumbersome, especially in Firefox where the Normandy Service
						really really likes to change privacy enhancing settings back, remotely, because an admin
						at Mozilla decided to do so.
					</p>
					<p>
						In order to find your Firefox Profile, visit
						<code>about:support</code>
						, then under the headline
						<code>Application Basics</code>
						next to
						<code>Profile Directory</code>
						you can click on
						<code>Open Directory</code>
						.
						This will open the file browser showing your Firefox Profile.
					</p>
					<p>
						In your Firefox Profile, you'll have to create a
						<code>user.js</code>
						file. This file is a simple
						line-based command-styled configuration file that will not be changed if Firefox gets
						updated or the Normandy service does funny stuff again.
					</p>
				</section>
				<section>
					<h2 id="disable-telemetry-service">Disable Telemetry Service</h2>
					<p>Firefox has a Telemetry service enabled by default. These are the settings to deactivate it.</p>
					<pre class="js">
user_pref("toolkit.telemetry.enabled", false);
user_pref("toolkit.telemetry.archive.enabled", false);
user_pref("toolkit.telemetry.unified", false);
user_pref("toolkit.telemetry.newProfilePing.enabled", false);
user_pref("toolkit.telemetry.shutdownPingSender.enabled", false);
user_pref("toolkit.telemetry.updatePing.enabled", false);
user_pref("toolkit.telemetry.bhrPing.enabled", false);
user_pref("toolkit.telemetry.firstShutdownPing.enabled", false);
user_pref("datareporting.healthreport.uploadEnabled", false);
user_pref("datareporting.policy.dataSubmissionEnabled", false);
user_pref("datareporting.sessions.current.clean", true);
user_pref("datareporting.sessions.current.activeTicks", 0);
user_pref("datareporting.healthreport.service.enabled", false);
					</pre>
				</section>
				<section>
					<h2 id="disable-normandy-services">Disable Normandy Services</h2>
					<p>
						Normandy is the Mozilla Service that will remote-install Extensions on your system,
						and change your local settings if a Mozilla Salesman decided it's good for you.
					</p>
					<p>
						Remember when Mozilla broke Adblockers remotely and disabled them?
						Yeah, that was the Normandy service.
					</p>
					<pre class="js">
user_pref("app.normandy.enabled", false);
user_pref("app.normandy.api_url", "http://0.0.0.0/normandy/v1");
user_pref("app.shield.optoutstudies.enabled", false);
					</pre>
				</section>
				<section>
					<h2 id="disable-crash-reporter">Disable Crash Reporter</h2>
					<p>Crash Reports contain Cookie data, Session data and other things that are nobody's business.</p>
					<pre class="js">
user_pref("breakpad.reportURL", "http://0.0.0.0/breakpad/report/index/");
user_pref("browser.tabs.crashReporting.sendReport", false);
					</pre>
				</section>
				<section>
					<h2 id="disable-google-safebrowsing">Disable Google Safebrowsing</h2>
					<p>Google Safebrowsing Reports contain Cookie data, Session data and other things that are nobody's business.</p>
					<pre class="js">
user_pref("browser.safebrowsing.malware.enabled", false);
user_pref("browser.safebrowsing.phishing.enabled", false);
user_pref("browser.safebrowsing.downloads.enabled", false);
user_pref("browser.safebrowsing.downloads.remote.enabled", false);
user_pref("browser.safebrowsing.downloads.remote.url", "");
user_pref("browser.safebrowsing.provider.google.updateURL", "http://0.0.0.0/safebrowsing/downloads?client=SAFEBROWSING_ID&appver=%MAJOR_VERSION%&pver=2.2&key=%GOOGLE_SAFEBROWSING_API_KEY%");
user_pref("browser.safebrowsing.provider.google.gethashURL", "http://0.0.0.0/safebrowsing/gethash?client=SAFEBROWSING_ID&appver=%MAJOR_VERSION%&pver=2.2");
user_pref("browser.safebrowsing.provider.mozilla.gethashURL", "http://0.0.0.0/safebrowsing/gethash?client=SAFEBROWSING_ID&appver=%MAJOR_VERSION%&pver=2.2");
user_pref("browser.safebrowsing.provider.mozilla.updateURL", "");
					</pre>
				</section>
				<section>
					<h2 id="disable-url-bar-suggestions">Disable URL Bar Suggestions</h2>
					<p>
						URL Search Bar suggestions will automatically predict what you're typing, even when you're just
						looking for an already visited (or bookmarked) page. That's not okay either.
					</p>
					<pre class="js">
user_pref("browser.urlbar.quicksuggest.enabled", false);
user_pref("browser.urlbar.sponsoredTopSites", false);
user_pref("browser.urlbar.suggest.quicksuggest.nonsponsored", false);
user_pref("browser.urlbar.suggest.quicksuggest.sponsored", false);
user_pref("browser.urlbar.suggest.topsites", false);
user_pref("browser.urlbar.suggest.engines", false);
user_pref("browser.urlbar.suggest.searches", false);
					</pre>
				</section>
				<section>
					<h2 id="disable-firefox-pocket">Disable Firefox Pocket</h2>
					<p>We all know Firefox Pocket, which nobody asked for and nobody wanted.</p>
					<pre class="js">
user_pref("extensions.pocket.api", "http://0.0.0.0/pocket");
user_pref("extensions.pocket.enabled", false);
user_pref("extensions.pocket.showHome", false);
user_pref("browser.newtabpage.activity-stream.discoverystream.saveToPocketCard.enabled", false);
					</pre>
				</section>
				<section>
					<h2 id="disable-network-prefetching">Disable Network Prefetching</h2>
					<p>
						Some websites contain
						<code><meta rel="dns-prefetch"></code>
						elements or the new
						<code><a ping="tracker.tld">...</a></code>
						attribute on HTML links. This will deactivate
						them as good as possible. Make sure you install uBlock Origin as an Extension
						to prevent further abuse.
					</p>
					<pre class="js">
user_pref("network.dns.disablePrefetch", true);
user_pref("network.prefetch-next", false);
user_pref("network.http.speculative-parallel-limit", 0);
user_pref("network.predictor.enabled", false);
user_pref("network.predictor.enable-prefetch", false);
user_pref("browser.urlbar.speculativeConnect.enabled", false);
					</pre>
				</section>
				<section>
					<h2 id="disable-geolocation-services">Disable Geolocation Services</h2>
					<p>
						Firefox uses
						<code>geoclue</code>
						as a library, which is usually a system-provided package
						or bundled library. But when that fails they'll of course track your location
						with their own geolocation API on every restart of the Browser. This fixes that.
					</p>
					<pre class="js">
user_pref("geo.enabled", false);
user_pref("geo.provider.network.url", "http://0.0.0.0/geolocation/v1/geolocate?key=%GOOGLE_LOCATION_SERVICE_API_KEY%");
user_pref("geo.provider.use_geoclue", false);
					</pre>
				</section>
				<section>
					<h2 id="disable-captive-portal-detector">Disable Captive Portal Detector</h2>
					<p>
						This might break Public Wi-Fis, because the captive portal service pings that URL
						every couple seconds to find out whether you were redirected to the Wi-Fi router's
						captive portal, e.g. the ones where you have to click on "Sell my firstborn child"
						first to use the internet.
					</p>
					<p>
						If you're using public Wi-Fis regularly and can't avoid this, I'd recommend to set
						the
						<code>captivedetect.canonicalURL</code>
						to the same one as the one that's configured in
						your Network Manager's settings. You can make the Feds chase wrong exploits by setting
						this to another distribution's default value, or at least slow them down quite a bit.
					</p>
					<pre class="js">
user_pref("network.captive-portal-service.enabled", false);
user_pref("captivedetect.canonicalURL", "http://detectportal.firefox.com/canonical.html");
					</pre>
					<table>
						<thead>
							<tr>
								<th align="left">Distribution</th>
								<th align="left">Network Connection Test URL</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td align="left">ArchLinux</td>
								<td align="left"><code>http://ping.archlinux.org/nm-check.txt</code></td>
							</tr>
							<tr>
								<td align="left">Debian</td>
								<td align="left"><code>http://network-test.debian.org/nm</code></td>
							</tr>
							<tr>
								<td align="left">RedHat</td>
								<td align="left"><code>http://static.redhat.com/test/rhel-networkmanager.txt</code></td>
							</tr>
							<tr>
								<td align="left">Ubuntu</td>
								<td align="left"><code>http://connectivity-check.ubuntu.com</code></td>
							</tr>
							<tr>
								<td align="left">macOS</td>
								<td align="left"><code>http://www.apple.com/library/test/success.html</code></td>
							</tr>
							<tr>
								<td align="left">macOSX or later</td>
								<td align="left"><code>http://captive.apple.com/hotspot-detect.html</code></td>
							</tr>
							<tr>
								<td align="left">Windows 8</td>
								<td align="left"><code>http://www.msftncsi.com/ncsi.txt</code></td>
							</tr>
							<tr>
								<td align="left">Windows 10</td>
								<td align="left"><code>http://www.msftconnecttest.com/connecttest.txt</code></td>
							</tr>
							<tr>
								<td align="left">Google Chrome</td>
								<td align="left"><code>http://connectivitycheck.gstatic.com/generate_204</code></td>
							</tr>
							<tr>
								<td align="left">Mozilla Firefox</td>
								<td align="left"><code>http://detectportal.firefox.com/canonical.html</code></td>
							</tr>
							<tr>
								<td align="left">Microsoft Edge</td>
								<td align="left"><code>http://edge-http.microsoft.com/captiveportal/generate_204</code></td>
							</tr>
						</tbody>
					</table>
				</section>
				<section>
					<h2 id="disable-tls-ocsp-checks">Disable TLS OCSP Checks</h2>
					<p>
						OCSP will receive copies of the server's TLS certificates, which means the
						google-provided server will know what encrypted websites you were browsing
						to. This fixes that.
					</p>
					<pre class="js">
user_pref("security.OCSP.enabled", 0);
user_pref("security.OCSP.required", false);
user_pref("security.ssl.enable_ocsp_must_staple", false);
user_pref("security.ssl.enable_ocsp_stapling", false);
					</pre>
				</section>
				<section>
					<h2 id="disable-privacy-compromising-dom-apis">Disable Privacy-Compromising DOM APIs</h2>
					<p>
						I don't know what is going on at the WHATWG, but these APIs and DOM features
						leak personal information about your system
					</p>
					<pre class="js">
// WebRTC Peer Connections leak private IP
user_pref("media.peerconnection.enabled", false);

// WebGL is used for Fingerprinting
user_pref("webgl.disabled", true);
user_pref("webgl.enable-webgl2", false);
user_pref("webgl.force-enabled", false);

// DOM Push Notifications
user_pref("dom.push.connection.enabled", false);
user_pref("dom.push.enabled", false);
user_pref("dom.push.serverURL", "ws://0.0.0.0/push-services");

// DOM Events
user_pref("dom.event.clipboardevents.enabled", false);
user_pref("dom.event.contextmenu.enabled", false);
user_pref("dom.battery.enabled", false);
user_pref("dom.gamepad.enabled", false);
user_pref("dom.gamepad.extensions.enabled", false);
user_pref("beacon.enabled", false);
					</pre>
				</section>
				<section>
					<h2 id="disable-new-tab-page-trackers">Disable New Tab Page Trackers</h2>
					<p>
						The New Page honestly is pretty much the worst in terms of Privacy and GDPR
						violations. I have no idea how Mozilla hasn't been sued into oblivion yet.
					</p>
					<p>
						Advertisers, Trackers, Social Feeds, pretty much everything will still be
						included and rendererd and called to every time you open a
						<code>New Tab</code>
						page,
						even if you set all settings to the most privacy-respecting ones. These
						settings will fix that.
					</p>
					<pre class="js">
// Start Page
user_pref("browser.startup.homepage", "about:blank");
user_pref("browser.preonboarding.enabled", false);
user_pref("startup.homepage_welcome_url", "");
user_pref("startup.homepage_welcome_url.additional", "");


// Tracker Feeds
user_pref("browser.newtabpage.activity-stream.showSponsored", false);
user_pref("browser.newtabpage.activity-stream.showSponsoredCheckboxes", false);
user_pref("browser.newtabpage.activity-stream.system.showSponsored", false);
user_pref("browser.newtabpage.activity-stream.system.showSponsoredCheckboxes", false);

user_pref("browser.newtabpage.activity-stream.feeds.adsfeeds", false);
user_pref("browser.newtabpage.activity-stream.feeds.discoverystreamfeed", false);
user_pref("browser.newtabpage.activity-stream.feeds.inferredpersonalizationfeed", false);
user_pref("browser.newtabpage.activity-stream.feeds.places", false);
user_pref("browser.newtabpage.activity-stream.feeds.recommendationprovider", false);
user_pref("browser.newtabpage.activity-stream.feeds.system.telemetry", false);
user_pref("browser.newtabpage.activity-stream.feeds.system.topsites", false);
user_pref("browser.newtabpage.activity-stream.feeds.system.topstories", false);
user_pref("browser.newtabpage.activity-stream.feeds.trendingsearchfeed", false);
user_pref("browser.newtabpage.activity-stream.feeds.wallpaperfeed", false);
user_pref("browser.newtabpage.activity-stream.feeds.weatherfeed", false);


user_pref("services.sync.prefs.sync.browser.newtabpage.activity-stream.feeds.section.highlights", false);
user_pref("services.sync.prefs.sync.browser.newtabpage.activity-stream.feeds.topsites", false);
user_pref("services.sync.prefs.sync.browser.newtabpage.activity-stream.feeds.section.topstories", false);
user_pref("services.sync.prefs.sync.browser.newtabpage.activity-stream.showSponsored", false);
user_pref("services.sync.prefs.sync.browser.newtabpage.activity-stream.showSponsoredTopSites", false);
					</pre>
				</section>
				<section>
					<h2 id="fingerprinting-and-cookies">Fingerprinting and Cookies</h2>
					<p>
						This is my paranoia calling, but I don't want a Browser History preserved
						on my system, especially not on my Laptop that I might lose (or get stolen)
						at any time that I cannot predict.
					</p>
					<pre class="js">
user_pref("privacy.resistFingerprinting", true);
user_pref("network.cookie.cookieBehavior", 1); // 1 = block 3rd party

user_pref("privacy.clearOnShutdown.cookies", true);
user_pref("privacy.clearOnShutdown.cache", true);
user_pref("privacy.clearOnShutdown.downloads", true);
user_pref("privacy.clearOnShutdown.formdata", true);
user_pref("privacy.clearOnShutdown.history", true);
user_pref("privacy.clearOnShutdown.sessions", true);
					</pre>
				</section>
				<section>
					<h2 id="privacy-enhancing-extensions">Privacy Enhancing Extensions</h2>
					<ul>
						<li>Install <a class="icon-github" href="https://github.com/gorhill/uBlock" target="_blank">uBlock Origin</a> to prevent websites from tracking you.</li>
						<li>Install <a class="icon-website" href="https://codeberg.org/nobody/LocalCDN" target="_blank">LocalCDN</a> to prevent CDNs from tracking you.</li>
					</ul>
				</section>
				<section>
					<h2 id="firejail">Firejail</h2>
					<p>
						For further Privacy on your system, I recommend the use of
						<a class="icon-github" href="https://github.com/netblue30/firejail" target="_blank">firejail</a>
						because it's a good enough approach if you cannot use advanced App Sandboxes like QubesOS
						would provide.
					</p>
					<p>
						Firejail will allow you to use Firefox essentially inside a sandbox, where it has access
						to a fake filesystem layer and can only reach the folders and files on your filesystem
						that you explicitely allowed it to access.
					</p>
					<p>
						In my case, Firefox has only access to the
						<code>~/Downloads</code>
						folder and nothing else.
					</p>
				</section>
			</article>
		</section>
		<footer>
			<p class="print-not">Made with ðŸ’” in Heidelberg, Germany. All rights (and jokes) reserved under European Law.</p>
			<p>&copy; Cookie Engineer (https://cookie.engineer). All rights reserved.</p>
		</footer>
	</body>
</html>
